%section.content
  .row
    .col-md-12
      .box.box-primary
        = form_for ["admin", @manager] do |f|
          = f.fields_for :user do |builder|
            .box-body
              %br
              .field
                %label User Name
                = builder.text_field :username, :class => 'form-control'
                - if @manager.user.errors[:username].any?
                  %span.myerror
                    = @manager.user.errors[:username].first
              %br
              .field
                %label Account Type
                %br
                = builder.select :account_type, options_for_select([["Select Account Type", ""], "Basic", "Premium"]), {}, :class => 'form-control'
                - if @manager.user.errors[:account_type].any?
                  %span.myerror
                    = @manager.user.errors[:account_type].first
              %br
              .field
                = builder.file_field :avatar, :id => "filePhoto"
                %img{:alt => "", :id => "imgPreview"} 
              %br
              .field
                %label Email
                %br
                = builder.text_field :email, :class => 'form-control'
                - if @manager.user.errors[:email].any?
                  %span.myerror
                    = @manager.user.errors[:email].first
              %br
              .field
                %label Password
                %br
                = builder.password_field :password, :class => 'form-control'
                - if @manager.user.errors[:password].any?
                  %span.myerror
                    = @manager.user.errors[:password].first
              %br
              .field
                %label Password Confirmation
                %br
                = builder.password_field :password_confirmation, :class => 'form-control'
                - if @manager.user.errors[:password_confirmation].any?
                  %span.myerror
                    = @manager.user.errors[:password_confirmation].first
              %br
              .field
                %label Company Name     
                %br  
                = f.text_field :company_name, :class => 'form-control'
                - if @manager.errors[:company_name].any?
                  %span.myerror
                    = @manager.errors[:company_name].first
              %br
              .field
                %label Phone Number     
                %br
                = f.text_field :phone_number, :class => 'form-control'
                - if @manager.errors[:phone_number].any?
                  %span.myerror
                    = @manager.errors[:phone_number].first
              %br
              .field
                %label Street     
                %br
                = f.text_field :street, :class => 'form-control'
                - if @manager.errors[:street].any?
                  %span.myerror
                    = @manager.errors[:street].first
              %br
              .field
                %label City   
                %br
                = f.text_field :city, :class => 'form-control'
                - if @manager.errors[:city].any?
                  %span.myerror
                    = @manager.errors[:city].first
              %br
              .field
                %label Postal Code     
                %br
                = f.text_field :postal_code, :class => 'form-control'
                - if @manager.errors[:postal_code].any?
                  %span.myerror
                    = @manager.errors[:postal_code].first
              %br
              .field
                %label State    
                %br
                = f.text_field :state, :class => 'form-control'
                - if @manager.errors[:state].any?
                  %span.myerror
                    = @manager.errors[:state].first
              %br
              .field
                %label Country     
                %br
                = f.text_field :country, :class => 'form-control'
                - if @manager.errors[:country].any?
                  %span.myerror
                    = @manager.errors[:country].first

              %br
              .field
                %label Company Description
                %br
                = f.text_area :company_description, :class => 'form-control'
              %br
              .field
                %label Page Url    
                %br
                = f.text_field :page_url, :class => 'form-control'
                / - if @manager.errors[:page_url].any?
                /   %span.myerror
                /     = @manager.errors[:page_url].first
              %br
              .field
                %label Add Page  
                %br
                = f.text_field :add_page, :class => 'form-control'
                / - if @manager.errors[:add_page].any?
                /   %span.myerror
                /     = @manager.errors[:add_page].first
              %br
              .checkbox
                %label
                  = f.check_box :verify_properties
                  Verify Properties
                - if @manager.errors[:verify_properties].any?
                  %br
                    %span.myerror
                      = @manager.errors[:verify_properties].first
              %br
              .checkbox
                %label
                  = f.check_box :estate_agent
                  Estate Agent
                - if @manager.errors[:estate_agent].any?
                  %br
                    %span.myerror
                      = @manager.errors[:estate_agent].first

              / %br
              / .checkbox
              /   %label
              /   = f.check_box :verify_properties
              /   Verify Properties
              /   - if @manager.errors[:verify_properties].any?
              /     %span
              /       = @manager.errors[:verify_properties].first
                    
              / %br
              / .checkbox
              /   %label
              /   = f.check_box :estate_agent
              /   Estate Agent
              /   - if @manager.errors[:estate_agent].any?
              /     %span
              /       = @manager.errors[:estate_agent].first
              %br
              .field
                %label Contact Person Full Name
                %br
                = f.text_field :contact_person_full_name, :class => 'form-control'
                - if @manager.errors[:contact_person_full_name].any?
                  %span.myerror
                    = @manager.errors[:contact_person_full_name].first
              %br
              .field
                %label Contact Person Email Address                
                %br
                = f.text_field :contact_person_email_address, :class => 'form-control'
                - if @manager.errors[:contact_person_email_address].any?
                  %span.myerror
                    = @manager.errors[:contact_person_email_address].first
              %br
              .field
                %label Contact Person Phone Number               
                %br
                = f.text_field :contact_person_phone_number, :class => 'form-control'
                - if @manager.errors[:contact_person_phone_number].any?
                  %span.myerror
                    = @manager.errors[:contact_person_phone_number].first
              %br
              .field
                %label Occupation
                %br
                = f.select :occupation, options_for_select([["Select occupation", ""], "Student", "Professional", "Other"]), {}, :class => 'form-control'
                - if @manager.errors[:occupation].any?
                  %span.myerror
                    = @manager.errors[:occupation].first
              %br
              .field
                %label Contact Person Position                
                %br
                = f.text_field :contact_person_position, :class => 'form-control'
                - if @manager.errors[:contact_person_position].any?
                  %span.myerror
                    = @manager.errors[:contact_person_position].first
              %br
              .field
                = f.file_field :contact_person_photo, :id => "contactImage"
                %img{:alt => "", :id => "personPhoto"} 
              %br
              .box-footer
                = f.submit 'Submit', :class => 'btn btn-primary' 
                = link_to 'Back', admin_managers_path, :class => 'btn btn-primary'
            / %br
            / .actions
            /   = f.submit 'Submit', :class => 'btn btn-primary' 
            /   = link_to 'Back', admin_managers_path, :class => 'btn btn-primary'
                
:javascript
  var imageLoader = document.getElementById('filePhoto');
      imageLoader.addEventListener('change', handleImage, false);
  function handleImage(e) {
      var reader = new FileReader();
      reader.onload = function (event) {
          $('#imgPreview').attr('src',event.target.result);
      }
      reader.readAsDataURL(e.target.files[0]);
  }

  var imageLoader = document.getElementById('contactImage');
      imageLoader.addEventListener('change', conImage, false);
  function conImage(e) {
      var myreader = new FileReader();
      myreader.onload = function (e) {
          $('#personPhoto').attr('src',e.target.result);
      }
      myreader.readAsDataURL(e.target.files[0]);
  }